import{r as n,o as s,c as a,a as t,b as e,w as o,F as c,d as l,f as p}from"./app.554c1b80.js";const i={},u=t("h1",{id:"getting-started-with-oauth2",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#getting-started-with-oauth2","aria-hidden":"true"},"#"),l(" Getting started with OAuth2")],-1),r=t("p",null,"OAuth2 enables application developers to build applications that utilize authentication and data from the Discord API. Developers can use this to create things such as web dashboards to display user info, fetch linked third-party accounts like Twitch or Steam, access users' guild information without actually being in the guild, and much more. OAuth2 can significantly extend the functionality of your bot if used correctly.",-1),k=t("h2",{id:"a-quick-example",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#a-quick-example","aria-hidden":"true"},"#"),l(" A quick example")],-1),h=t("h3",{id:"setting-up-a-basic-web-server",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#setting-up-a-basic-web-server","aria-hidden":"true"},"#"),l(" Setting up a basic web server")],-1),d=l("Most of the time, websites use OAuth2 to get information about their users from an external service. In this example, we will use "),g={href:"https://expressjs.com/",target:"_blank",rel:"noopener noreferrer"},b=t("code",null,"express",-1),m=l(" to create a web server to use a user's Discord information to greet them. Start by creating three files: "),f=t("code",null,"config.json",-1),y=l(", "),v=t("code",null,"index.js",-1),w=l(", and "),x=t("code",null,"index.html",-1),j=l("."),_=t("p",null,[t("code",null,"config.json"),l(" will be used to store the client ID, client secret, and server port.")],-1),R=t("div",{class:"language-json ext-json line-numbers-mode"},[t("pre",{class:"language-json"},[t("code",null,[t("span",{class:"token punctuation"},"{"),l("\n\t"),t("span",{class:"token property"},'"clientId"'),t("span",{class:"token operator"},":"),l(),t("span",{class:"token string"},'""'),t("span",{class:"token punctuation"},","),l("\n\t"),t("span",{class:"token property"},'"clientSecret"'),t("span",{class:"token operator"},":"),l(),t("span",{class:"token string"},'""'),t("span",{class:"token punctuation"},","),l("\n\t"),t("span",{class:"token property"},'"port"'),t("span",{class:"token operator"},":"),l(),t("span",{class:"token number"},"53134"),l("\n"),t("span",{class:"token punctuation"},"}"),l("\n")])]),t("div",{class:"line-numbers"},[t("span",{class:"line-number"},"1"),t("br"),t("span",{class:"line-number"},"2"),t("br"),t("span",{class:"line-number"},"3"),t("br"),t("span",{class:"line-number"},"4"),t("br"),t("span",{class:"line-number"},"5"),t("br")])],-1),A=t("p",null,[t("code",null,"index.js"),l(" will be used to start the server and handle requests. When someone visits the index page ("),t("code",null,"/"),l("), an HTML file will be sent in response.")],-1),U=t("div",{class:"language-javascript ext-js line-numbers-mode"},[t("pre",{class:"language-javascript"},[t("code",null,[t("span",{class:"token keyword"},"const"),l(" express "),t("span",{class:"token operator"},"="),l(),t("span",{class:"token function"},"require"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'express'"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n"),t("span",{class:"token keyword"},"const"),l(),t("span",{class:"token punctuation"},"{"),l(" port "),t("span",{class:"token punctuation"},"}"),l(),t("span",{class:"token operator"},"="),l(),t("span",{class:"token function"},"require"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'./config.json'"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n\n"),t("span",{class:"token keyword"},"const"),l(" app "),t("span",{class:"token operator"},"="),l(),t("span",{class:"token function"},"express"),t("span",{class:"token punctuation"},"("),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n\napp"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"get"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'/'"),t("span",{class:"token punctuation"},","),l(),t("span",{class:"token punctuation"},"("),t("span",{class:"token parameter"},[l("request"),t("span",{class:"token punctuation"},","),l(" response")]),t("span",{class:"token punctuation"},")"),l(),t("span",{class:"token operator"},"=>"),l(),t("span",{class:"token punctuation"},"{"),l("\n\t"),t("span",{class:"token keyword"},"return"),l(" response"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"sendFile"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'index.html'"),t("span",{class:"token punctuation"},","),l(),t("span",{class:"token punctuation"},"{"),l(" root"),t("span",{class:"token operator"},":"),l(),t("span",{class:"token string"},"'.'"),l(),t("span",{class:"token punctuation"},"}"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n"),t("span",{class:"token punctuation"},"}"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n\napp"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"listen"),t("span",{class:"token punctuation"},"("),l("port"),t("span",{class:"token punctuation"},","),l(),t("span",{class:"token punctuation"},"("),t("span",{class:"token punctuation"},")"),l(),t("span",{class:"token operator"},"=>"),l(" console"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"log"),t("span",{class:"token punctuation"},"("),t("span",{class:"token template-string"},[t("span",{class:"token template-punctuation string"},"`"),t("span",{class:"token string"},"App listening at http://localhost:"),t("span",{class:"token interpolation"},[t("span",{class:"token interpolation-punctuation punctuation"},"${"),l("port"),t("span",{class:"token interpolation-punctuation punctuation"},"}")]),t("span",{class:"token template-punctuation string"},"`")]),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n")])]),t("div",{class:"line-numbers"},[t("span",{class:"line-number"},"1"),t("br"),t("span",{class:"line-number"},"2"),t("br"),t("span",{class:"line-number"},"3"),t("br"),t("span",{class:"line-number"},"4"),t("br"),t("span",{class:"line-number"},"5"),t("br"),t("span",{class:"line-number"},"6"),t("br"),t("span",{class:"line-number"},"7"),t("br"),t("span",{class:"line-number"},"8"),t("br"),t("span",{class:"line-number"},"9"),t("br"),t("span",{class:"line-number"},"10"),t("br")])],-1),L=t("p",null,[t("code",null,"index.html"),l(" will be used to display the user interface and OAuth data once logged in.")],-1),q=t("div",{class:"language-html ext-html line-numbers-mode"},[t("pre",{class:"language-html"},[t("code",null,[t("span",{class:"token doctype"},[t("span",{class:"token punctuation"},"<!"),t("span",{class:"token doctype-tag"},"DOCTYPE"),l(),t("span",{class:"token name"},"html"),t("span",{class:"token punctuation"},">")]),l("\n"),t("span",{class:"token tag"},[t("span",{class:"token tag"},[t("span",{class:"token punctuation"},"<"),l("html")]),t("span",{class:"token punctuation"},">")]),l("\n"),t("span",{class:"token tag"},[t("span",{class:"token tag"},[t("span",{class:"token punctuation"},"<"),l("head")]),t("span",{class:"token punctuation"},">")]),l("\n\t"),t("span",{class:"token tag"},[t("span",{class:"token tag"},[t("span",{class:"token punctuation"},"<"),l("title")]),t("span",{class:"token punctuation"},">")]),l("My Discord OAuth2 App"),t("span",{class:"token tag"},[t("span",{class:"token tag"},[t("span",{class:"token punctuation"},"</"),l("title")]),t("span",{class:"token punctuation"},">")]),l("\n"),t("span",{class:"token tag"},[t("span",{class:"token tag"},[t("span",{class:"token punctuation"},"</"),l("head")]),t("span",{class:"token punctuation"},">")]),l("\n"),t("span",{class:"token tag"},[t("span",{class:"token tag"},[t("span",{class:"token punctuation"},"<"),l("body")]),t("span",{class:"token punctuation"},">")]),l("\n\t"),t("span",{class:"token tag"},[t("span",{class:"token tag"},[t("span",{class:"token punctuation"},"<"),l("div")]),l(),t("span",{class:"token attr-name"},"id"),t("span",{class:"token attr-value"},[t("span",{class:"token punctuation attr-equals"},"="),t("span",{class:"token punctuation"},'"'),l("info"),t("span",{class:"token punctuation"},'"')]),t("span",{class:"token punctuation"},">")]),l("\n\t\tHoi!\n\t"),t("span",{class:"token tag"},[t("span",{class:"token tag"},[t("span",{class:"token punctuation"},"</"),l("div")]),t("span",{class:"token punctuation"},">")]),l("\n"),t("span",{class:"token tag"},[t("span",{class:"token tag"},[t("span",{class:"token punctuation"},"</"),l("body")]),t("span",{class:"token punctuation"},">")]),l("\n"),t("span",{class:"token tag"},[t("span",{class:"token tag"},[t("span",{class:"token punctuation"},"</"),l("html")]),t("span",{class:"token punctuation"},">")]),l("\n")])]),t("div",{class:"line-numbers"},[t("span",{class:"line-number"},"1"),t("br"),t("span",{class:"line-number"},"2"),t("br"),t("span",{class:"line-number"},"3"),t("br"),t("span",{class:"line-number"},"4"),t("br"),t("span",{class:"line-number"},"5"),t("br"),t("span",{class:"line-number"},"6"),t("br"),t("span",{class:"line-number"},"7"),t("br"),t("span",{class:"line-number"},"8"),t("br"),t("span",{class:"line-number"},"9"),t("br"),t("span",{class:"line-number"},"10"),t("br"),t("span",{class:"line-number"},"11"),t("br")])],-1),T=t("p",null,[l("After running "),t("code",null,"npm i express"),l(", you can start your server with "),t("code",null,"node index.js"),l(". Once started, connect to "),t("code",null,"http://localhost:53134"),l(', and you should see "Hoi!".')],-1),S={class:"custom-container tip"},O=t("p",{class:"custom-container-title"},"TIP",-1),D=l("Although we're using express, there are many other alternatives to handle a web server, such as: "),I={href:"https://www.fastify.io/",target:"_blank",rel:"noopener noreferrer"},z=l("fastify"),P=l(", "),C={href:"https://koajs.com/",target:"_blank",rel:"noopener noreferrer"},N=l("koa"),Y=l(", and the "),F={href:"https://nodejs.org/api/http.html",target:"_blank",rel:"noopener noreferrer"},M=l("native Node.js http module"),$=l("."),E=t("h3",{id:"getting-an-oauth2-url",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#getting-an-oauth2-url","aria-hidden":"true"},"#"),l(" Getting an OAuth2 URL")],-1),B=l("Now that you have a web server up and running, it's time to get some information from Discord. Open "),H={href:"https://discord.com/developers/applications/",target:"_blank",rel:"noopener noreferrer"},W=l("your Discord applications"),G=l(', create or select an application, and head over to the "OAuth2" page.'),V=t("p",null,[t("img",{src:"/assets/oauth2-app-page.0ae45536.png",alt:"OAuth2 application page"})],-1),J=t("p",null,[l("Take note of the "),t("code",null,"client id"),l(" and "),t("code",null,"client secret"),l(" fields. Copy these values into your "),t("code",null,"config.json"),l(" file; you'll need them later. For now, add a redirect URL to "),t("code",null,"http://localhost:53134"),l(" like so:")],-1),K=t("p",null,[t("img",{src:"/assets/add-redirects.d748f69c.png",alt:"Adding Redirects"})],-1),Q=t("p",null,[l("Once you've added your redirect URL, you will want to generate an OAuth2 URL. Lower down on the page, you can conveniently find an OAuth2 URL Generator provided by Discord. Use this to create a URL for yourself with the "),t("code",null,"identify"),l(" scope.")],-1),X=t("p",null,[t("img",{src:"/assets/generate-url.b2eacdce.png",alt:"Generate an OAuth2 URL"})],-1),Z=l("The "),nn=t("code",null,"identify",-1),sn=l(" scope will allow your application to get basic user information from Discord. You can find a list of all scopes "),an={href:"https://discord.com/developers/docs/topics/oauth2#shared-resources-oauth2-scopes",target:"_blank",rel:"noopener noreferrer"},tn=l("here"),en=l("."),on=t("h3",{id:"implicit-grant-flow",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#implicit-grant-flow","aria-hidden":"true"},"#"),l(" Implicit grant flow")],-1),cn=l("You have your website, and you have a URL. Now you need to use those two things to get an access token. For basic applications like "),ln={href:"https://en.wikipedia.org/wiki/Single-page_application",target:"_blank",rel:"noopener noreferrer"},pn=l("SPAs"),un=l(", getting an access token directly is enough. You can do so by changing the "),rn=t("code",null,"response_type",-1),kn=l(" in the URL to "),hn=t("code",null,"token",-1),dn=l(". However, this means you will not get a refresh token, which means the user will have to explicitly re-authorize when this access token has expired."),gn=t("p",null,[l("After you change the "),t("code",null,"response_type"),l(", you can test the URL right away. Visiting it in your browser, you will be directed to a page that looks like this:")],-1),bn=t("p",null,[t("img",{src:"/assets/authorize-app-page.ac905253.png",alt:"Authorization Page"})],-1),mn=l("You can see that by clicking "),fn=t("code",null,"Authorize",-1),yn=l(", you allow the application to access your username and avatar. Once you click through, it will redirect you to your redirect URL with a "),vn={href:"https://en.wikipedia.org/wiki/Fragment_identifier",target:"_blank",rel:"noopener noreferrer"},wn=l("fragment identifier"),xn=l(" appended to it. You now have an access token and can make requests to Discord's API to get information on the user."),jn=l("Modify "),_n=t("code",null,"index.html",-1),Rn=l(" to add your OAuth2 URL and to take advantage of the access token if it exists. Even though "),An={href:"https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams",target:"_blank",rel:"noopener noreferrer"},Un=t("code",null,"URLSearchParams",-1),Ln=l(' is for working with query strings, it can work here because the structure of the fragment follows that of a query string after removing the leading "#".'),qn=t("div",{class:"language-html ext-html line-numbers-mode"},[t("pre",{class:"language-html"},[t("code",null,[t("span",{class:"token tag"},[t("span",{class:"token tag"},[t("span",{class:"token punctuation"},"<"),l("div")]),l(),t("span",{class:"token attr-name"},"id"),t("span",{class:"token attr-value"},[t("span",{class:"token punctuation attr-equals"},"="),t("span",{class:"token punctuation"},'"'),l("info"),t("span",{class:"token punctuation"},'"')]),t("span",{class:"token punctuation"},">")]),l("\n\tHoi!\n"),t("span",{class:"token tag"},[t("span",{class:"token tag"},[t("span",{class:"token punctuation"},"</"),l("div")]),t("span",{class:"token punctuation"},">")]),l("\n"),t("span",{class:"token tag"},[t("span",{class:"token tag"},[t("span",{class:"token punctuation"},"<"),l("a")]),l(),t("span",{class:"token attr-name"},"id"),t("span",{class:"token attr-value"},[t("span",{class:"token punctuation attr-equals"},"="),t("span",{class:"token punctuation"},'"'),l("login"),t("span",{class:"token punctuation"},'"')]),l(),t("span",{class:"token special-attr"},[t("span",{class:"token attr-name"},"style"),t("span",{class:"token attr-value"},[t("span",{class:"token punctuation attr-equals"},"="),t("span",{class:"token punctuation"},'"'),t("span",{class:"token value css language-css"},[t("span",{class:"token property"},"display"),t("span",{class:"token punctuation"},":"),l(" none"),t("span",{class:"token punctuation"},";")]),t("span",{class:"token punctuation"},'"')])]),l(),t("span",{class:"token attr-name"},"href"),t("span",{class:"token attr-value"},[t("span",{class:"token punctuation attr-equals"},"="),t("span",{class:"token punctuation"},'"'),l("your-oauth2-URL-here"),t("span",{class:"token punctuation"},'"')]),t("span",{class:"token punctuation"},">")]),l("Identify Yourself"),t("span",{class:"token tag"},[t("span",{class:"token tag"},[t("span",{class:"token punctuation"},"</"),l("a")]),t("span",{class:"token punctuation"},">")]),l("\n"),t("span",{class:"token tag"},[t("span",{class:"token tag"},[t("span",{class:"token punctuation"},"<"),l("script")]),t("span",{class:"token punctuation"},">")]),t("span",{class:"token script"},[t("span",{class:"token language-javascript"},[l("\n\twindow"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function-variable function"},"onload"),l(),t("span",{class:"token operator"},"="),l(),t("span",{class:"token punctuation"},"("),t("span",{class:"token punctuation"},")"),l(),t("span",{class:"token operator"},"=>"),l(),t("span",{class:"token punctuation"},"{"),l("\n\t\t"),t("span",{class:"token keyword"},"const"),l(" fragment "),t("span",{class:"token operator"},"="),l(),t("span",{class:"token keyword"},"new"),l(),t("span",{class:"token class-name"},"URLSearchParams"),t("span",{class:"token punctuation"},"("),l("window"),t("span",{class:"token punctuation"},"."),l("location"),t("span",{class:"token punctuation"},"."),l("hash"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"slice"),t("span",{class:"token punctuation"},"("),t("span",{class:"token number"},"1"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n\t\t"),t("span",{class:"token keyword"},"const"),l(),t("span",{class:"token punctuation"},"["),l("accessToken"),t("span",{class:"token punctuation"},","),l(" tokenType"),t("span",{class:"token punctuation"},"]"),l(),t("span",{class:"token operator"},"="),l(),t("span",{class:"token punctuation"},"["),l("fragment"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"get"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'access_token'"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},","),l(" fragment"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"get"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'token_type'"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},"]"),t("span",{class:"token punctuation"},";"),l("\n\n\t\t"),t("span",{class:"token keyword"},"if"),l(),t("span",{class:"token punctuation"},"("),t("span",{class:"token operator"},"!"),l("accessToken"),t("span",{class:"token punctuation"},")"),l(),t("span",{class:"token punctuation"},"{"),l("\n\t\t\t"),t("span",{class:"token keyword"},"return"),l(" document"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"getElementById"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'login'"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},"."),l("style"),t("span",{class:"token punctuation"},"."),l("display "),t("span",{class:"token operator"},"="),l(),t("span",{class:"token string"},"'block'"),t("span",{class:"token punctuation"},";"),l("\n\t\t"),t("span",{class:"token punctuation"},"}"),l("\n\n\t\t"),t("span",{class:"token function"},"fetch"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'https://discord.com/api/users/@me'"),t("span",{class:"token punctuation"},","),l(),t("span",{class:"token punctuation"},"{"),l("\n\t\t\theaders"),t("span",{class:"token operator"},":"),l(),t("span",{class:"token punctuation"},"{"),l("\n\t\t\t\tauthorization"),t("span",{class:"token operator"},":"),l(),t("span",{class:"token template-string"},[t("span",{class:"token template-punctuation string"},"`"),t("span",{class:"token interpolation"},[t("span",{class:"token interpolation-punctuation punctuation"},"${"),l("tokenType"),t("span",{class:"token interpolation-punctuation punctuation"},"}")]),t("span",{class:"token string"}," "),t("span",{class:"token interpolation"},[t("span",{class:"token interpolation-punctuation punctuation"},"${"),l("accessToken"),t("span",{class:"token interpolation-punctuation punctuation"},"}")]),t("span",{class:"token template-punctuation string"},"`")]),t("span",{class:"token punctuation"},","),l("\n\t\t\t"),t("span",{class:"token punctuation"},"}"),t("span",{class:"token punctuation"},","),l("\n\t\t"),t("span",{class:"token punctuation"},"}"),t("span",{class:"token punctuation"},")"),l("\n\t\t\t"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"then"),t("span",{class:"token punctuation"},"("),t("span",{class:"token parameter"},"result"),l(),t("span",{class:"token operator"},"=>"),l(" result"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"json"),t("span",{class:"token punctuation"},"("),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},")"),l("\n\t\t\t"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"then"),t("span",{class:"token punctuation"},"("),t("span",{class:"token parameter"},"response"),l(),t("span",{class:"token operator"},"=>"),l(),t("span",{class:"token punctuation"},"{"),l("\n\t\t\t\t"),t("span",{class:"token keyword"},"const"),l(),t("span",{class:"token punctuation"},"{"),l(" username"),t("span",{class:"token punctuation"},","),l(" discriminator "),t("span",{class:"token punctuation"},"}"),l(),t("span",{class:"token operator"},"="),l(" response"),t("span",{class:"token punctuation"},";"),l("\n\t\t\t\tdocument"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"getElementById"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'info'"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},"."),l("innerText "),t("span",{class:"token operator"},"+="),l(),t("span",{class:"token template-string"},[t("span",{class:"token template-punctuation string"},"`"),t("span",{class:"token string"}," "),t("span",{class:"token interpolation"},[t("span",{class:"token interpolation-punctuation punctuation"},"${"),l("username"),t("span",{class:"token interpolation-punctuation punctuation"},"}")]),t("span",{class:"token string"},"#"),t("span",{class:"token interpolation"},[t("span",{class:"token interpolation-punctuation punctuation"},"${"),l("discriminator"),t("span",{class:"token interpolation-punctuation punctuation"},"}")]),t("span",{class:"token template-punctuation string"},"`")]),t("span",{class:"token punctuation"},";"),l("\n\t\t\t"),t("span",{class:"token punctuation"},"}"),t("span",{class:"token punctuation"},")"),l("\n\t\t\t"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"catch"),t("span",{class:"token punctuation"},"("),l("console"),t("span",{class:"token punctuation"},"."),l("error"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n\t"),t("span",{class:"token punctuation"},"}"),t("span",{class:"token punctuation"},";"),l("\n")])]),t("span",{class:"token tag"},[t("span",{class:"token tag"},[t("span",{class:"token punctuation"},"</"),l("script")]),t("span",{class:"token punctuation"},">")]),l("\n")])]),t("div",{class:"highlight-lines"},[t("br"),t("br"),t("br"),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," ")]),t("div",{class:"line-numbers"},[t("span",{class:"line-number"},"1"),t("br"),t("span",{class:"line-number"},"2"),t("br"),t("span",{class:"line-number"},"3"),t("br"),t("span",{class:"line-number"},"4"),t("br"),t("span",{class:"line-number"},"5"),t("br"),t("span",{class:"line-number"},"6"),t("br"),t("span",{class:"line-number"},"7"),t("br"),t("span",{class:"line-number"},"8"),t("br"),t("span",{class:"line-number"},"9"),t("br"),t("span",{class:"line-number"},"10"),t("br"),t("span",{class:"line-number"},"11"),t("br"),t("span",{class:"line-number"},"12"),t("br"),t("span",{class:"line-number"},"13"),t("br"),t("span",{class:"line-number"},"14"),t("br"),t("span",{class:"line-number"},"15"),t("br"),t("span",{class:"line-number"},"16"),t("br"),t("span",{class:"line-number"},"17"),t("br"),t("span",{class:"line-number"},"18"),t("br"),t("span",{class:"line-number"},"19"),t("br"),t("span",{class:"line-number"},"20"),t("br"),t("span",{class:"line-number"},"21"),t("br"),t("span",{class:"line-number"},"22"),t("br"),t("span",{class:"line-number"},"23"),t("br"),t("span",{class:"line-number"},"24"),t("br"),t("span",{class:"line-number"},"25"),t("br"),t("span",{class:"line-number"},"26"),t("br")])],-1),Tn=l("Here you grab the access token and type from the URL if it's there and use it to get info on the user, which is then used to greet them. The response you get from the "),Sn={href:"https://discord.com/developers/docs/resources/user#get-current-user",target:"_blank",rel:"noopener noreferrer"},On=t("code",null,"/api/users/@me",-1),Dn=l(" endpoint"),In=l(" is a "),zn={href:"https://discord.com/developers/docs/resources/user#user-object",target:"_blank",rel:"noopener noreferrer"},Pn=l("user object"),Cn=l(" and should look something like this:"),Nn=t("div",{class:"language-json ext-json line-numbers-mode"},[t("pre",{class:"language-json"},[t("code",null,[t("span",{class:"token punctuation"},"{"),l("\n\t"),t("span",{class:"token property"},'"id"'),t("span",{class:"token operator"},":"),l(),t("span",{class:"token string"},'"123456789012345678"'),t("span",{class:"token punctuation"},","),l("\n\t"),t("span",{class:"token property"},'"username"'),t("span",{class:"token operator"},":"),l(),t("span",{class:"token string"},'"User"'),t("span",{class:"token punctuation"},","),l("\n\t"),t("span",{class:"token property"},'"discriminator"'),t("span",{class:"token operator"},":"),l(),t("span",{class:"token string"},'"0001"'),t("span",{class:"token punctuation"},","),l("\n\t"),t("span",{class:"token property"},'"avatar"'),t("span",{class:"token operator"},":"),l(),t("span",{class:"token string"},'"1cc0a3b14aec3499632225c708451d67"'),t("span",{class:"token punctuation"},","),l("\n\t...\n"),t("span",{class:"token punctuation"},"}"),l("\n")])]),t("div",{class:"line-numbers"},[t("span",{class:"line-number"},"1"),t("br"),t("span",{class:"line-number"},"2"),t("br"),t("span",{class:"line-number"},"3"),t("br"),t("span",{class:"line-number"},"4"),t("br"),t("span",{class:"line-number"},"5"),t("br"),t("span",{class:"line-number"},"6"),t("br"),t("span",{class:"line-number"},"7"),t("br")])],-1),Yn=t("p",null,"In the following sections, we'll go over various details of Discord and OAuth2.",-1),Fn=t("h2",{id:"more-details",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#more-details","aria-hidden":"true"},"#"),l(" More details")],-1),Mn=t("h3",{id:"the-state-parameter",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#the-state-parameter","aria-hidden":"true"},"#"),l(" The state parameter")],-1),$n=l("OAuth2's protocols provide a "),En=t("code",null,"state",-1),Bn=l(" parameter, which Discord supports. This parameter helps prevent "),Hn={href:"https://en.wikipedia.org/wiki/Cross-site_request_forgery",target:"_blank",rel:"noopener noreferrer"},Wn=l("CSRF"),Gn=l(" attacks and represents your application's state. The state should be generated per user and appended to the OAuth2 URL. For a basic example, you can use a randomly generated string encoded in Base64 as the state parameter."),Vn=t("div",{class:"language-javascript ext-js line-numbers-mode"},[t("pre",{class:"language-javascript"},[t("code",null,[t("span",{class:"token keyword"},"function"),l(),t("span",{class:"token function"},"generateRandomString"),t("span",{class:"token punctuation"},"("),t("span",{class:"token punctuation"},")"),l(),t("span",{class:"token punctuation"},"{"),l("\n\t"),t("span",{class:"token keyword"},"let"),l(" randomString "),t("span",{class:"token operator"},"="),l(),t("span",{class:"token string"},"''"),t("span",{class:"token punctuation"},";"),l("\n\t"),t("span",{class:"token keyword"},"const"),l(" randomNumber "),t("span",{class:"token operator"},"="),l(" Math"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"floor"),t("span",{class:"token punctuation"},"("),l("Math"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"random"),t("span",{class:"token punctuation"},"("),t("span",{class:"token punctuation"},")"),l(),t("span",{class:"token operator"},"*"),l(),t("span",{class:"token number"},"10"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n\n\t"),t("span",{class:"token keyword"},"for"),l(),t("span",{class:"token punctuation"},"("),t("span",{class:"token keyword"},"let"),l(" i "),t("span",{class:"token operator"},"="),l(),t("span",{class:"token number"},"0"),t("span",{class:"token punctuation"},";"),l(" i "),t("span",{class:"token operator"},"<"),l(),t("span",{class:"token number"},"20"),l(),t("span",{class:"token operator"},"+"),l(" randomNumber"),t("span",{class:"token punctuation"},";"),l(" i"),t("span",{class:"token operator"},"++"),t("span",{class:"token punctuation"},")"),l(),t("span",{class:"token punctuation"},"{"),l("\n\t\trandomString "),t("span",{class:"token operator"},"+="),l(" String"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"fromCharCode"),t("span",{class:"token punctuation"},"("),t("span",{class:"token number"},"33"),l(),t("span",{class:"token operator"},"+"),l(" Math"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"floor"),t("span",{class:"token punctuation"},"("),l("Math"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"random"),t("span",{class:"token punctuation"},"("),t("span",{class:"token punctuation"},")"),l(),t("span",{class:"token operator"},"*"),l(),t("span",{class:"token number"},"94"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n\t"),t("span",{class:"token punctuation"},"}"),l("\n\n\t"),t("span",{class:"token keyword"},"return"),l(" randomString"),t("span",{class:"token punctuation"},";"),l("\n"),t("span",{class:"token punctuation"},"}"),l("\n\nwindow"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function-variable function"},"onload"),l(),t("span",{class:"token operator"},"="),l(),t("span",{class:"token punctuation"},"("),t("span",{class:"token punctuation"},")"),l(),t("span",{class:"token operator"},"=>"),l(),t("span",{class:"token punctuation"},"{"),l("\n\t"),t("span",{class:"token comment"},"// ..."),l("\n\t"),t("span",{class:"token keyword"},"if"),l(),t("span",{class:"token punctuation"},"("),t("span",{class:"token operator"},"!"),l("accessToken"),t("span",{class:"token punctuation"},")"),l(),t("span",{class:"token punctuation"},"{"),l("\n\t\t"),t("span",{class:"token keyword"},"const"),l(" randomString "),t("span",{class:"token operator"},"="),l(),t("span",{class:"token function"},"generateRandomString"),t("span",{class:"token punctuation"},"("),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n\t\tlocalStorage"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"setItem"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'oauth-state'"),t("span",{class:"token punctuation"},","),l(" randomString"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n\n\t\tdocument"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"getElementById"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'login'"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},"."),l("href "),t("span",{class:"token operator"},"+="),l(),t("span",{class:"token template-string"},[t("span",{class:"token template-punctuation string"},"`"),t("span",{class:"token string"},"&state="),t("span",{class:"token interpolation"},[t("span",{class:"token interpolation-punctuation punctuation"},"${"),t("span",{class:"token function"},"btoa"),t("span",{class:"token punctuation"},"("),l("randomString"),t("span",{class:"token punctuation"},")"),t("span",{class:"token interpolation-punctuation punctuation"},"}")]),t("span",{class:"token template-punctuation string"},"`")]),t("span",{class:"token punctuation"},";"),l("\n\t\t"),t("span",{class:"token keyword"},"return"),l(" document"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"getElementById"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'login'"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},"."),l("style"),t("span",{class:"token punctuation"},"."),l("display "),t("span",{class:"token operator"},"="),l(),t("span",{class:"token string"},"'block'"),t("span",{class:"token punctuation"},";"),l("\n\t"),t("span",{class:"token punctuation"},"}"),l("\n"),t("span",{class:"token punctuation"},"}"),t("span",{class:"token punctuation"},";"),l("\n")])]),t("div",{class:"highlight-lines"},[t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("br"),t("br"),t("br"),t("br"),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("br"),t("br"),t("br")]),t("div",{class:"line-numbers"},[t("span",{class:"line-number"},"1"),t("br"),t("span",{class:"line-number"},"2"),t("br"),t("span",{class:"line-number"},"3"),t("br"),t("span",{class:"line-number"},"4"),t("br"),t("span",{class:"line-number"},"5"),t("br"),t("span",{class:"line-number"},"6"),t("br"),t("span",{class:"line-number"},"7"),t("br"),t("span",{class:"line-number"},"8"),t("br"),t("span",{class:"line-number"},"9"),t("br"),t("span",{class:"line-number"},"10"),t("br"),t("span",{class:"line-number"},"11"),t("br"),t("span",{class:"line-number"},"12"),t("br"),t("span",{class:"line-number"},"13"),t("br"),t("span",{class:"line-number"},"14"),t("br"),t("span",{class:"line-number"},"15"),t("br"),t("span",{class:"line-number"},"16"),t("br"),t("span",{class:"line-number"},"17"),t("br"),t("span",{class:"line-number"},"18"),t("br"),t("span",{class:"line-number"},"19"),t("br"),t("span",{class:"line-number"},"20"),t("br"),t("span",{class:"line-number"},"21"),t("br")])],-1),Jn=t("p",null,[l("When you visit a URL with a "),t("code",null,"state"),l(" parameter appended to it and then click "),t("code",null,"Authorize"),l(", you'll notice that after being redirected, the URL will also have the "),t("code",null,"state"),l(" parameter appended, which you should then check against what was stored. You can modify the script in your "),t("code",null,"index.html"),l(" file to handle this.")],-1),Kn=t("div",{class:"language-javascript ext-js line-numbers-mode"},[t("pre",{class:"language-javascript"},[t("code",null,[t("span",{class:"token keyword"},"const"),l(" fragment "),t("span",{class:"token operator"},"="),l(),t("span",{class:"token keyword"},"new"),l(),t("span",{class:"token class-name"},"URLSearchParams"),t("span",{class:"token punctuation"},"("),l("window"),t("span",{class:"token punctuation"},"."),l("location"),t("span",{class:"token punctuation"},"."),l("hash"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"slice"),t("span",{class:"token punctuation"},"("),t("span",{class:"token number"},"1"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n"),t("span",{class:"token keyword"},"const"),l(),t("span",{class:"token punctuation"},"["),l("accessToken"),t("span",{class:"token punctuation"},","),l(" tokenType"),t("span",{class:"token punctuation"},","),l(" state"),t("span",{class:"token punctuation"},"]"),l(),t("span",{class:"token operator"},"="),l(),t("span",{class:"token punctuation"},"["),l("fragment"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"get"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'access_token'"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},","),l(" fragment"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"get"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'token_type'"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},","),l(" fragment"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"get"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'state'"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},"]"),t("span",{class:"token punctuation"},";"),l("\n\n"),t("span",{class:"token keyword"},"if"),l(),t("span",{class:"token punctuation"},"("),t("span",{class:"token operator"},"!"),l("accessToken"),t("span",{class:"token punctuation"},")"),l(),t("span",{class:"token punctuation"},"{"),l("\n\t"),t("span",{class:"token comment"},"// ..."),l("\n"),t("span",{class:"token punctuation"},"}"),l("\n\n"),t("span",{class:"token keyword"},"if"),l(),t("span",{class:"token punctuation"},"("),l("localStorage"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"getItem"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'oauth-state'"),t("span",{class:"token punctuation"},")"),l(),t("span",{class:"token operator"},"!=="),l(),t("span",{class:"token function"},"atob"),t("span",{class:"token punctuation"},"("),t("span",{class:"token function"},"decodeURIComponent"),t("span",{class:"token punctuation"},"("),l("state"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},")"),l(),t("span",{class:"token punctuation"},"{"),l("\n\t"),t("span",{class:"token keyword"},"return"),l(" console"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"log"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'You may have been clickjacked!'"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n"),t("span",{class:"token punctuation"},"}"),l("\n")])]),t("div",{class:"highlight-lines"},[t("br"),t("div",{class:"highlight-line"}," "),t("br"),t("br"),t("br"),t("br"),t("br"),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," ")]),t("div",{class:"line-numbers"},[t("span",{class:"line-number"},"1"),t("br"),t("span",{class:"line-number"},"2"),t("br"),t("span",{class:"line-number"},"3"),t("br"),t("span",{class:"line-number"},"4"),t("br"),t("span",{class:"line-number"},"5"),t("br"),t("span",{class:"line-number"},"6"),t("br"),t("span",{class:"line-number"},"7"),t("br"),t("span",{class:"line-number"},"8"),t("br"),t("span",{class:"line-number"},"9"),t("br"),t("span",{class:"line-number"},"10"),t("br")])],-1),Qn=t("div",{class:"custom-container tip"},[t("p",{class:"custom-container-title"},"TIP"),t("p",null,"Don't forgo security for a tiny bit of convenience!")],-1),Xn=t("h3",{id:"authorization-code-grant-flow",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#authorization-code-grant-flow","aria-hidden":"true"},"#"),l(" Authorization code grant flow")],-1),Zn=t("p",null,[l("What you did in the quick example was go through the "),t("code",null,"implicit grant"),l(" flow, which passed the access token straight to the user's browser. This flow is great and simple, but you don't get to refresh the token without the user, and it is less secure than going through the "),t("code",null,"authorization code grant"),l(" flow. This flow involves receiving an access code, which your server then exchanges for an access token. Notice that this way, the access token never actually reaches the user throughout the process.")],-1),ns=l("Unlike the "),ss=l("implicit grant flow"),as=p(", you need an OAuth2 URL where the <code>response_type</code> is <code>code</code>. After you change the <code>response_type</code>, try visiting the link and authorizing your application. You should notice that instead of a hash, the redirect URL now has a single query parameter appended to it, i.e. <code>?code=ACCESS_CODE</code>. Modify your <code>index.js</code> file to access the parameter from the URL if it exists. In express, you can use the <code>request</code> parameter&#39;s <code>query</code> property.",15),ts=t("div",{class:"language-javascript ext-js line-numbers-mode"},[t("pre",{class:"language-javascript"},[t("code",null,[l("app"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"get"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'/'"),t("span",{class:"token punctuation"},","),l(),t("span",{class:"token punctuation"},"("),t("span",{class:"token parameter"},[l("request"),t("span",{class:"token punctuation"},","),l(" response")]),t("span",{class:"token punctuation"},")"),l(),t("span",{class:"token operator"},"=>"),l(),t("span",{class:"token punctuation"},"{"),l("\n\tconsole"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"log"),t("span",{class:"token punctuation"},"("),t("span",{class:"token template-string"},[t("span",{class:"token template-punctuation string"},"`"),t("span",{class:"token string"},"The access code is: "),t("span",{class:"token interpolation"},[t("span",{class:"token interpolation-punctuation punctuation"},"${"),l("request"),t("span",{class:"token punctuation"},"."),l("query"),t("span",{class:"token punctuation"},"."),l("code"),t("span",{class:"token interpolation-punctuation punctuation"},"}")]),t("span",{class:"token template-punctuation string"},"`")]),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n\t"),t("span",{class:"token keyword"},"return"),l(" response"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"sendFile"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'index.html'"),t("span",{class:"token punctuation"},","),l(),t("span",{class:"token punctuation"},"{"),l(" root"),t("span",{class:"token operator"},":"),l(),t("span",{class:"token string"},"'.'"),l(),t("span",{class:"token punctuation"},"}"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n"),t("span",{class:"token punctuation"},"}"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n")])]),t("div",{class:"highlight-lines"},[t("br"),t("div",{class:"highlight-line"}," "),t("br"),t("br")]),t("div",{class:"line-numbers"},[t("span",{class:"line-number"},"1"),t("br"),t("span",{class:"line-number"},"2"),t("br"),t("span",{class:"line-number"},"3"),t("br"),t("span",{class:"line-number"},"4"),t("br")])],-1),es=l("Now you have to exchange this code with Discord for an access token. To do this, you need your "),os=t("code",null,"client_id",-1),cs=l(" and "),ls=t("code",null,"client_secret",-1),ps=l(". If you've forgotten these, head over to "),is={href:"https://discord.com/developers/applications",target:"_blank",rel:"noopener noreferrer"},us=l("your applications"),rs=l(" and get them. You can use "),ks={href:"https://www.npmjs.com/package/node-fetch",target:"_blank",rel:"noopener noreferrer"},hs=t("code",null,"node-fetch",-1),ds=l(" to make requests to Discord; you can install it with "),gs=t("code",null,"npm i node-fetch",-1),bs=l("."),ms=t("p",null,[l("Require "),t("code",null,"node-fetch"),l(" and make your request.")],-1),fs=t("div",{class:"language-javascript ext-js line-numbers-mode"},[t("pre",{class:"language-javascript"},[t("code",null,[t("span",{class:"token keyword"},"const"),l(" fetch "),t("span",{class:"token operator"},"="),l(),t("span",{class:"token function"},"require"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'node-fetch'"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n"),t("span",{class:"token keyword"},"const"),l(" express "),t("span",{class:"token operator"},"="),l(),t("span",{class:"token function"},"require"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'express'"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n"),t("span",{class:"token keyword"},"const"),l(),t("span",{class:"token punctuation"},"{"),l(" clientId"),t("span",{class:"token punctuation"},","),l(" clientSecret"),t("span",{class:"token punctuation"},","),l(" port "),t("span",{class:"token punctuation"},"}"),l(),t("span",{class:"token operator"},"="),l(),t("span",{class:"token function"},"require"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'./config.json'"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n\n"),t("span",{class:"token keyword"},"const"),l(" app "),t("span",{class:"token operator"},"="),l(),t("span",{class:"token function"},"express"),t("span",{class:"token punctuation"},"("),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n\napp"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"get"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'/'"),t("span",{class:"token punctuation"},","),l(),t("span",{class:"token keyword"},"async"),l(),t("span",{class:"token punctuation"},"("),t("span",{class:"token parameter"},[t("span",{class:"token punctuation"},"{"),l(" query "),t("span",{class:"token punctuation"},"}"),t("span",{class:"token punctuation"},","),l(" response")]),t("span",{class:"token punctuation"},")"),l(),t("span",{class:"token operator"},"=>"),l(),t("span",{class:"token punctuation"},"{"),l("\n\t"),t("span",{class:"token keyword"},"const"),l(),t("span",{class:"token punctuation"},"{"),l(" code "),t("span",{class:"token punctuation"},"}"),l(),t("span",{class:"token operator"},"="),l(" query"),t("span",{class:"token punctuation"},";"),l("\n\n\t"),t("span",{class:"token keyword"},"if"),l(),t("span",{class:"token punctuation"},"("),l("code"),t("span",{class:"token punctuation"},")"),l(),t("span",{class:"token punctuation"},"{"),l("\n\t\t"),t("span",{class:"token keyword"},"try"),l(),t("span",{class:"token punctuation"},"{"),l("\n\t\t\t"),t("span",{class:"token keyword"},"const"),l(" oauthResult "),t("span",{class:"token operator"},"="),l(),t("span",{class:"token keyword"},"await"),l(),t("span",{class:"token function"},"fetch"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'https://discord.com/api/oauth2/token'"),t("span",{class:"token punctuation"},","),l(),t("span",{class:"token punctuation"},"{"),l("\n\t\t\t\tmethod"),t("span",{class:"token operator"},":"),l(),t("span",{class:"token string"},"'POST'"),t("span",{class:"token punctuation"},","),l("\n\t\t\t\tbody"),t("span",{class:"token operator"},":"),l(),t("span",{class:"token keyword"},"new"),l(),t("span",{class:"token class-name"},"URLSearchParams"),t("span",{class:"token punctuation"},"("),t("span",{class:"token punctuation"},"{"),l("\n\t\t\t\t\tclient_id"),t("span",{class:"token operator"},":"),l(" clientId"),t("span",{class:"token punctuation"},","),l("\n\t\t\t\t\tclient_secret"),t("span",{class:"token operator"},":"),l(" clientSecret"),t("span",{class:"token punctuation"},","),l("\n\t\t\t\t\tcode"),t("span",{class:"token punctuation"},","),l("\n\t\t\t\t\tgrant_type"),t("span",{class:"token operator"},":"),l(),t("span",{class:"token string"},"'authorization_code'"),t("span",{class:"token punctuation"},","),l("\n\t\t\t\t\tredirect_uri"),t("span",{class:"token operator"},":"),l(),t("span",{class:"token template-string"},[t("span",{class:"token template-punctuation string"},"`"),t("span",{class:"token string"},"http://localhost:"),t("span",{class:"token interpolation"},[t("span",{class:"token interpolation-punctuation punctuation"},"${"),l("port"),t("span",{class:"token interpolation-punctuation punctuation"},"}")]),t("span",{class:"token template-punctuation string"},"`")]),t("span",{class:"token punctuation"},","),l("\n\t\t\t\t\tscope"),t("span",{class:"token operator"},":"),l(),t("span",{class:"token string"},"'identify'"),t("span",{class:"token punctuation"},","),l("\n\t\t\t\t"),t("span",{class:"token punctuation"},"}"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},","),l("\n\t\t\t\theaders"),t("span",{class:"token operator"},":"),l(),t("span",{class:"token punctuation"},"{"),l("\n\t\t\t\t\t"),t("span",{class:"token string"},"'Content-Type'"),t("span",{class:"token operator"},":"),l(),t("span",{class:"token string"},"'application/x-www-form-urlencoded'"),t("span",{class:"token punctuation"},","),l("\n\t\t\t\t"),t("span",{class:"token punctuation"},"}"),t("span",{class:"token punctuation"},","),l("\n\t\t\t"),t("span",{class:"token punctuation"},"}"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n\n\t\t\t"),t("span",{class:"token keyword"},"const"),l(" oauthData "),t("span",{class:"token operator"},"="),l(),t("span",{class:"token keyword"},"await"),l(" oauthResult"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"json"),t("span",{class:"token punctuation"},"("),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n\t\t\tconsole"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"log"),t("span",{class:"token punctuation"},"("),l("oauthData"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n\t\t"),t("span",{class:"token punctuation"},"}"),l(),t("span",{class:"token keyword"},"catch"),l(),t("span",{class:"token punctuation"},"("),l("error"),t("span",{class:"token punctuation"},")"),l(),t("span",{class:"token punctuation"},"{"),l("\n\t\t\t"),t("span",{class:"token comment"},"// NOTE: An unauthorized token will not throw an error;"),l("\n\t\t\t"),t("span",{class:"token comment"},"// it will return a 401 Unauthorized response in the try block above"),l("\n\t\t\tconsole"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"error"),t("span",{class:"token punctuation"},"("),l("error"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n\t\t"),t("span",{class:"token punctuation"},"}"),l("\n\t"),t("span",{class:"token punctuation"},"}"),l("\n\n\t"),t("span",{class:"token keyword"},"return"),l(" response"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"sendFile"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'index.html'"),t("span",{class:"token punctuation"},","),l(),t("span",{class:"token punctuation"},"{"),l(" root"),t("span",{class:"token operator"},":"),l(),t("span",{class:"token string"},"'.'"),l(),t("span",{class:"token punctuation"},"}"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n"),t("span",{class:"token punctuation"},"}"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n")])]),t("div",{class:"highlight-lines"},[t("div",{class:"highlight-line"}," "),t("br"),t("div",{class:"highlight-line"}," "),t("br"),t("br"),t("br"),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("br"),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("br"),t("br"),t("br")]),t("div",{class:"line-numbers"},[t("span",{class:"line-number"},"1"),t("br"),t("span",{class:"line-number"},"2"),t("br"),t("span",{class:"line-number"},"3"),t("br"),t("span",{class:"line-number"},"4"),t("br"),t("span",{class:"line-number"},"5"),t("br"),t("span",{class:"line-number"},"6"),t("br"),t("span",{class:"line-number"},"7"),t("br"),t("span",{class:"line-number"},"8"),t("br"),t("span",{class:"line-number"},"9"),t("br"),t("span",{class:"line-number"},"10"),t("br"),t("span",{class:"line-number"},"11"),t("br"),t("span",{class:"line-number"},"12"),t("br"),t("span",{class:"line-number"},"13"),t("br"),t("span",{class:"line-number"},"14"),t("br"),t("span",{class:"line-number"},"15"),t("br"),t("span",{class:"line-number"},"16"),t("br"),t("span",{class:"line-number"},"17"),t("br"),t("span",{class:"line-number"},"18"),t("br"),t("span",{class:"line-number"},"19"),t("br"),t("span",{class:"line-number"},"20"),t("br"),t("span",{class:"line-number"},"21"),t("br"),t("span",{class:"line-number"},"22"),t("br"),t("span",{class:"line-number"},"23"),t("br"),t("span",{class:"line-number"},"24"),t("br"),t("span",{class:"line-number"},"25"),t("br"),t("span",{class:"line-number"},"26"),t("br"),t("span",{class:"line-number"},"27"),t("br"),t("span",{class:"line-number"},"28"),t("br"),t("span",{class:"line-number"},"29"),t("br"),t("span",{class:"line-number"},"30"),t("br"),t("span",{class:"line-number"},"31"),t("br"),t("span",{class:"line-number"},"32"),t("br"),t("span",{class:"line-number"},"33"),t("br"),t("span",{class:"line-number"},"34"),t("br"),t("span",{class:"line-number"},"35"),t("br"),t("span",{class:"line-number"},"36"),t("br"),t("span",{class:"line-number"},"37"),t("br")])],-1),ys=t("div",{class:"custom-container warning"},[t("p",{class:"custom-container-title"},"WARNING"),t("p",null,[l("The content-type for the token URL must be "),t("code",null,"application/x-www-form-urlencoded"),l(", which is why "),t("code",null,"URLSearchParams"),l(" is used.")])],-1),vs=l("Now try visiting your OAuth2 URL and authorizing your application. Once you're redirected, you should see an "),ws={href:"https://discord.com/developers/docs/topics/oauth2#authorization-code-grant-access-token-response",target:"_blank",rel:"noopener noreferrer"},xs=l("access token response"),js=l(" in your console."),_s=t("div",{class:"language-json ext-json line-numbers-mode"},[t("pre",{class:"language-json"},[t("code",null,[t("span",{class:"token punctuation"},"{"),l("\n\t"),t("span",{class:"token property"},'"access_token"'),t("span",{class:"token operator"},":"),l(),t("span",{class:"token string"},'"an access token"'),t("span",{class:"token punctuation"},","),l("\n\t"),t("span",{class:"token property"},'"token_type"'),t("span",{class:"token operator"},":"),l(),t("span",{class:"token string"},'"Bearer"'),t("span",{class:"token punctuation"},","),l("\n\t"),t("span",{class:"token property"},'"expires_in"'),t("span",{class:"token operator"},":"),l(),t("span",{class:"token number"},"604800"),t("span",{class:"token punctuation"},","),l("\n\t"),t("span",{class:"token property"},'"refresh_token"'),t("span",{class:"token operator"},":"),l(),t("span",{class:"token string"},'"a refresh token"'),t("span",{class:"token punctuation"},","),l("\n\t"),t("span",{class:"token property"},'"scope"'),t("span",{class:"token operator"},":"),l(),t("span",{class:"token string"},'"identify"'),l("\n"),t("span",{class:"token punctuation"},"}"),l("\n")])]),t("div",{class:"line-numbers"},[t("span",{class:"line-number"},"1"),t("br"),t("span",{class:"line-number"},"2"),t("br"),t("span",{class:"line-number"},"3"),t("br"),t("span",{class:"line-number"},"4"),t("br"),t("span",{class:"line-number"},"5"),t("br"),t("span",{class:"line-number"},"6"),t("br"),t("span",{class:"line-number"},"7"),t("br")])],-1),Rs=l("With an access token and a refresh token, you can once again use the "),As={href:"https://discord.com/developers/docs/resources/user#get-current-user",target:"_blank",rel:"noopener noreferrer"},Us=t("code",null,"/api/users/@me",-1),Ls=l(" endpoint"),qs=l(" to fetch the "),Ts={href:"https://discord.com/developers/docs/resources/user#user-object",target:"_blank",rel:"noopener noreferrer"},Ss=l("user object"),Os=l("."),Ds=t("div",{class:"language-javascript ext-js line-numbers-mode"},[t("pre",{class:"language-javascript"},[t("code",null,[t("span",{class:"token keyword"},"const"),l(" oauthData "),t("span",{class:"token operator"},"="),l(),t("span",{class:"token keyword"},"await"),l(" oauthResult"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"json"),t("span",{class:"token punctuation"},"("),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n\n"),t("span",{class:"token keyword"},"const"),l(" userResult "),t("span",{class:"token operator"},"="),l(),t("span",{class:"token keyword"},"await"),l(),t("span",{class:"token function"},"fetch"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},"'https://discord.com/api/users/@me'"),t("span",{class:"token punctuation"},","),l(),t("span",{class:"token punctuation"},"{"),l("\n\theaders"),t("span",{class:"token operator"},":"),l(),t("span",{class:"token punctuation"},"{"),l("\n\t\tauthorization"),t("span",{class:"token operator"},":"),l(),t("span",{class:"token template-string"},[t("span",{class:"token template-punctuation string"},"`"),t("span",{class:"token interpolation"},[t("span",{class:"token interpolation-punctuation punctuation"},"${"),l("oauthData"),t("span",{class:"token punctuation"},"."),l("token_type"),t("span",{class:"token interpolation-punctuation punctuation"},"}")]),t("span",{class:"token string"}," "),t("span",{class:"token interpolation"},[t("span",{class:"token interpolation-punctuation punctuation"},"${"),l("oauthData"),t("span",{class:"token punctuation"},"."),l("access_token"),t("span",{class:"token interpolation-punctuation punctuation"},"}")]),t("span",{class:"token template-punctuation string"},"`")]),t("span",{class:"token punctuation"},","),l("\n\t"),t("span",{class:"token punctuation"},"}"),t("span",{class:"token punctuation"},","),l("\n"),t("span",{class:"token punctuation"},"}"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n\nconsole"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"log"),t("span",{class:"token punctuation"},"("),t("span",{class:"token keyword"},"await"),l(" userResult"),t("span",{class:"token punctuation"},"."),t("span",{class:"token function"},"json"),t("span",{class:"token punctuation"},"("),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),l("\n")])]),t("div",{class:"highlight-lines"},[t("br"),t("br"),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("div",{class:"highlight-line"}," "),t("br"),t("div",{class:"highlight-line"}," ")]),t("div",{class:"line-numbers"},[t("span",{class:"line-number"},"1"),t("br"),t("span",{class:"line-number"},"2"),t("br"),t("span",{class:"line-number"},"3"),t("br"),t("span",{class:"line-number"},"4"),t("br"),t("span",{class:"line-number"},"5"),t("br"),t("span",{class:"line-number"},"6"),t("br"),t("span",{class:"line-number"},"7"),t("br"),t("span",{class:"line-number"},"8"),t("br"),t("span",{class:"line-number"},"9"),t("br")])],-1),Is=t("div",{class:"custom-container tip"},[t("p",{class:"custom-container-title"},"TIP"),t("p",null,"To maintain security, store the access token server-side but associate it with a session ID that you generate for the user.")],-1),zs=t("h2",{id:"additional-reading",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#additional-reading","aria-hidden":"true"},"#"),l(" Additional reading")],-1),Ps={href:"https://tools.ietf.org/html/rfc6749",target:"_blank",rel:"noopener noreferrer"},Cs=l("RFC 6759"),Ns=t("br",null,null,-1),Ys={href:"https://discord.com/developers/docs/topics/oauth2",target:"_blank",rel:"noopener noreferrer"},Fs=l("Discord Docs for OAuth2"),Ms=t("h2",{id:"resulting-code",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#resulting-code","aria-hidden":"true"},"#"),l(" Resulting code")],-1);i.render=function(l,p){const i=n("OutboundLink"),$s=n("RouterLink"),Es=n("ResultingCode");return s(),a(c,null,[u,r,k,h,t("p",null,[d,t("a",g,[b,e(i)]),m,f,y,v,w,x,j]),_,R,A,U,L,q,T,t("div",S,[O,t("p",null,[D,t("a",I,[z,e(i)]),P,t("a",C,[N,e(i)]),Y,t("a",F,[M,e(i)]),$])]),E,t("p",null,[B,t("a",H,[W,e(i)]),G]),V,J,K,Q,X,t("p",null,[Z,nn,sn,t("a",an,[tn,e(i)]),en]),on,t("p",null,[cn,t("a",ln,[pn,e(i)]),un,rn,kn,hn,dn]),gn,bn,t("p",null,[mn,fn,yn,t("a",vn,[wn,e(i)]),xn]),t("p",null,[jn,_n,Rn,t("a",An,[Un,e(i)]),Ln]),qn,t("p",null,[Tn,t("a",Sn,[On,Dn,e(i)]),In,t("a",zn,[Pn,e(i)]),Cn]),Nn,Yn,Fn,Mn,t("p",null,[$n,En,Bn,t("a",Hn,[Wn,e(i)]),Gn]),Vn,Jn,Kn,Qn,Xn,Zn,t("p",null,[ns,e($s,{to:"/oauth2/#implicit-grant-flow"},{default:o((()=>[ss])),_:1}),as]),ts,t("p",null,[es,os,cs,ls,ps,t("a",is,[us,e(i)]),rs,t("a",ks,[hs,e(i)]),ds,gs,bs]),ms,fs,ys,t("p",null,[vs,t("a",ws,[xs,e(i)]),js]),_s,t("p",null,[Rs,t("a",As,[Us,Ls,e(i)]),qs,t("a",Ts,[Ss,e(i)]),Os]),Ds,Is,zs,t("p",null,[t("a",Ps,[Cs,e(i)]),Ns,t("a",Ys,[Fs,e(i)])]),Ms,e(Es,{path:"oauth/simple-oauth-webserver"})],64)};export{i as default};
